# Security Configuration Assessment
# CIS Checks for Debian Linux 12
# Copyright (C) 2023, Wazuh Inc.
#
# This program is free software; you can redistribute it
# and/or modify it under the terms of the GNU General Public
# License (version 2) as published by the FSF - Free Software
# Foundation
#
# Based on:
# Center for Internet Security Debian Family Linux Benchmark v1.0.0 - 09-03-2020

policy:
  id: "cis_debian12"
  file: "cis_debian12.yml"
  name: "Center for Internet Security Debian Family Linux Benchmark v1.0.0"
  description: "This document provides prescriptive guidance for establishing a secure configuration posture for Debian Linux 12."
  references:
    - https://www.cisecurity.org/cis-benchmarks/

requirements:
  title: "Check Debian version."
  description: "Requirements for running the SCA scan against Debian Linux 12."
  condition: all
  rules:
    - "f:/etc/debian_version -> r:12."
    - "f:/proc/sys/kernel/ostype -> r:Linux"
    - "f:/etc/os-release -> r:NAME= && r:Debian"
    - "f:/etc/os-release -> r:VERSION= && r:12"

checks:
  ############################################################
  # 1 Initial Setup
  ############################################################
  # 1.1 Filesystem configuration
  ############################################################
  # 1.1.1 Disable unused filesystems
  ############################################################

  # 1.1.1.1 Ensure mounting of cramfs filesystems is disabled (Automated)
  - id: 29500
    title: "Ensure mounting of cramfs filesystems is disabled."
    description: "The cramfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems. A cramfs image can be used without having to first decompress the image."
    rationale: "Removing support for unneeded filesystem types reduces the local attack surface of the server. If this filesystem type is not needed, disable it."
    remediation: "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vim /etc/modprobe.d/cramfs.conf and add the following line: install cramfs /bin/true Run the following command to unload the cramfs module: # rmmod cramfs."
    compliance:
      - cis: ["1.1.1.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "c:modprobe -n -v cramfs -> r:install /bin/true"
      - "not c:lsmod -> r:cramfs"

  # 1.1.1.2 Ensure mounting of freevxfs filesystems is disabled (Automated)
  - id: 29500
    title: "Ensure mounting of freevxfs filesystems is disabled."
    description: "The freevxfs filesystem type is a free version of the Veritas type filesystem. This is the primary filesystem type for HP-UX operating systems."
    rationale: "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it."
    remediation: "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/freevxfs.conf and add the following line: install freevxfs /bin/true Run the following command to unload the freevxfs module: rmmod freevxfs."
    compliance:
      - cis: ["1.1.1.2"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "c:modprobe -n -v freevxfs -> r: install /bin/true"
      - "not c:lsmod -> r:freevxfs"

  # 1.1.1.3 Ensure mounting of jffs2 filesystems is disabled (Automated)
  - id: 29500
    title: "Ensure mounting of jffs2 filesystems is disabled."
    description: "The jffs2 (journaling flash filesystem 2) filesystem type is a log-structured filesystem used in flash memory devices."
    rationale: "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it."
    remediation: "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/jffs2.conf and add the following line: install jffs2 /bin/true Run the following command to unload the jffs2 module: # rmmod jffs2."
    compliance:
      - cis: ["1.1.1.3"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "c:modprobe -n -v jffs2 -> r:install /bin/true"
      - "not c:lsmod -> r:jffs2"

  # 1.1.1.4 Ensure mounting of hfs filesystems is disabled (Automated)
  - id: 29500
    title: "Ensure mounting of hfs filesystems is disabled."
    description: "The hfs filesystem type is a hierarchical filesystem that allows you to mount Mac OS filesystems."
    rationale: "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it."
    remediation: "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/hfs.conf and add the following line: install hfs /bin/true Run the following command to unload the hfs module: # rmmod hfs."
    compliance:
      - cis: ["1.1.1.4"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "c:modprobe -n -v hfs -> r:install /bin/true"
      - "not c:lsmod -> r:hfs"

  # 1.1.1.5 Ensure mounting of hfsplus filesystems is disabled (Automated)
  - id: 29500
    title: "Ensure mounting of hfsplus filesystems is disabled."
    description: "The hfsplus filesystem type is a hierarchical filesystem designed to replace hfs that allows you to mount Mac OS filesystems."
    rationale: "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it."
    remediation: "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/hfsplus.conf and add the following line: install hfsplus /bin/true Run the following command to unload the hfsplus module: # rmmod hfsplus."
    compliance:
      - cis: ["1.1.1.5"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "c:modprobe -n -v hfsplus -> r:install /bin/true"
      - "not c:lsmod -> r:hfsplus"

  # 1.1.1.6 Ensure mounting of squashfs filesystems is disabled (Manual)
  - id: 29500
    title: "Ensure mounting of squashfs filesystems is disabled."
    description: "The squashfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems (similar to cramfs ). A squashfs image can be used without having to first decompress the image."
    rationale: "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it."
    impact: "Disabling squashfs will prevent the use of snap. Snap is a package manager for Linux for installing Snap packages. 'Snap' application packages of software are self-contained and work across a range of Linux distributions. This is unlike traditional Linux package management approaches, like APT or RPM, which require specifically adapted packages per Linux distribution on an application update and delay therefore application deployment from developers to their software's end-user. Snaps themselves have no dependency on any external store ('App store'), can be obtained from any source and can be therefore used for upstream software deployment. When snaps are deployed on versions of Linux, the Ubuntu app store is used as default back-end, but other stores can be enabled as well."
    remediation: "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/squashfs.conf Add the following line: install squashfs /bin/true Run the following command to unload the squashfs module: # rmmod squashfs."
    compliance:
      - cis: ["1.1.1.6"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "c:modprobe -n -v squashfs -> r:install /bin/true"
      - "not c:lsmod -> r:squashfs"

  # 1.1.1.7 Ensure mounting of udf filesystems is disabled (Automated)
  - id: 29500
    title: "Ensure mounting of udf filesystems is disabled."
    description: "The udf filesystem type is the universal disk format used to implement ISO/IEC 13346 and ECMA-167 specifications. This is an open vendor filesystem type for data storage on a broad range of media. This filesystem type is necessary to support writing DVDs and newer optical disc formats."
    rationale: "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it."
    remediation: "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/udf.conf and add the following line: install udf /bin/true Run the following command to unload the udf module: # rmmod udf."
    compliance:
      - cis: ["1.1.1.7"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "c:modprobe -n -v udf -> r:install /bin/true"
      - "not c:lsmod -> r:udf"

  # 1.1.2 Ensure /tmp is configured (Automated)
  - id: 29500
    title: "Ensure /tmp is configured."
    description: "The /tmp directory is a world-writable directory used for temporary storage by all users and some applications. Notes: - If an entry for /tmp exists in /etc/fstab it will take precedence over entries in the tmp.mount file. - tmpfs can be resized using the size={size} parameter in /etc/fstab or on the Options line in the tmp.mount file. If we don't specify the size, it will be half the RAM. Resize tmpfs examples: - /etc/fstab tmpfs /tmp tmpfs rw,noexec,nodev,nosuid,size=2G 0 0 - tmp.mount [Mount] What=tmpfs Where=/tmp Type=tmpfs Options=mode=1777,strictatime,size=2G,noexec,nodev,nosuid."
    rationale: "Making /tmp its own file system allows an administrator to set the noexec option on the mount, making /tmp useless for an attacker to install executable code. It would also prevent an attacker from establishing a hardlink to a system setuid program and wait for it to be updated. Once the program was updated, the hardlink would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw. This can be accomplished by either mounting tmpfs to /tmp, or creating a separate partition for /tmp."
    impact: "Since the /tmp directory is intended to be world-writable, there is a risk of resource exhaustion if it is not bound to a separate partition. Running out of /tmp space is a problem regardless of what kind of filesystem lies under it, but in a default installation a disk-based /tmp will essentially have the whole disk available, as it only creates a single / partition. On the other hand, a RAM-based /tmp as with tmpfs will almost certainly be much smaller, which can lead to applications filling up the filesystem much more easily. /tmp utilizing tmpfs can be resized using the size={size} parameter on the Options line on the tmp.mount file."
    remediation: "Configure /etc/fstab as appropriate. Example: tmpfs /tmp tmpfs defaults,rw,nosuid,nodev,noexec,relatime 0 0 OR Run the following commands to enable systemd /tmp mounting: Run the following command to create the tmp.mount file is the correct location: # cp -v /usr/share/systemd/tmp.mount /etc/systemd/system/ Edit /etc/systemd/system/tmp.mount to configure the /tmp mount: [Mount] What=tmpfs Where=/tmp Type=tmpfs Options=mode=1777,strictatime,nosuid,nodev,noexec Run the following command to reload the systemd daemon with the unpdated tmp.mount unit file: # systemctl daemon-reload Run the following command to enable and start tmp.mount # systemctl --now enable tmp.mount."
    references:
      - http://tldp.org/HOWTO/LVM-HOWTO/
      - https://www.freedesktop.org/wiki/Software/systemd/APIFileSystems/
    compliance:
      - cis: ["1.1.2"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "c:mount -> r:tmpfs on /tmp type tmpfs"
      - "f:/etc/fstab -> r:tmpfs /tmp tmpfs"

  # 1.1.3 Ensure nodev option set on /tmp partition (Automated)
  - id: 29500
    title: "Ensure nodev option set on /tmp partition."
    description: "The nodev mount option specifies that the filesystem cannot contain special devices."
    rationale: "Since the /tmp filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /tmp."
    remediation: "Edit the /etc/fstab file OR the /etc/systemd/system/local-fs.target.wants/tmp.mount file: IF /etc/fstab is used to mount /tmp Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /tmp partition. See the fstab(5) manual page for more information. Run the following command to remount /tmp: # mount -o remount,nodev /tmp OR IF systemd is used to mount /tmp: Edit /etc/systemd/system/local-fs.target.wants/tmp.mount to add nodev to the /tmp mount options: [Mount] Options=mode=1777,strictatime noexec,nodev,nosuid Run the following command to restart the systemd daemon: # systemctl daemon-reload Run the following command to restart tmp.mount # systemctl restart tmp.mount."
    compliance:
      - cis: ["1.1.3"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "c:mount -> r:tmpfs on /tmp type tmpfs && r:nodev"

  # 1.1.4 Ensure nosuid option set on /tmp partition (Automated)
  - id: 29500
    title: "Ensure nosuid option set on /tmp partition."
    description: "The nosuid mount option specifies that the filesystem cannot contain setuid files."
    rationale: "Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /tmp."
    remediation: "Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /tmp partition. See the fstab(5) manual page for more information. Run the following command to remount /tmp : # mount -o remount,nosuid /tmp OR Edit /etc/systemd/system/local-fs.target.wants/tmp.mount to add nosuid to the /tmp mount options: [Mount] Options=mode=1777,strictatime,noexec,nodev,nosuid Run the following command to remount /tmp : # mount -o remount,nosuid /tmp."
    compliance:
      - cis: ["1.1.4"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "c:mount -> r:tmpfs on /tmp type tmpfs && r:nosuid"

  # 1.1.5 Ensure noexec option set on /tmp partition (Automated)
  - id: 29500
    title: "Ensure noexec option set on /tmp partition."
    description: "The noexec mount option specifies that the filesystem cannot contain executable binaries."
    rationale: "Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /tmp."
    remediation: "Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /tmp partition. See the fstab(5) manual page for more information. Run the following command to remount /tmp : # mount -o remount,noexec /tmp OR Edit /etc/systemd/system/local-fs.target.wants/tmp.mount to add noexec to the /tmp mount options: [Mount] Options=mode=1777,strictatime,noexec,nodev,nosuid Run the following command to remount /tmp : # mount -o remount,noexec /tmp."
    compliance:
      - cis: ["1.1.5"]
      - cis_csc_v7: ["2.6"]
      - cmmc_v2.0: ["CM.2.063", "CM.3.069", "CM.4.073"]
      - iso_27001-2013: ["A.12.5.1", "A.12.6.2"]
      - mitre_techniques: ["T1191", "T1092", "T1175", "T1173", "T1519", "T1052", "T1210", "T1133", "T1118", "T1171", "T1170", "T1046", "T1137", "T1086", "T1164", "T1121", "T1076", "T1091", "T1180", "T1064", "T1184", "T1221", "T1127", "T1028"]
      - nist_sp_800-53: ["CM-11"]
    condition: all
    rules:
      - "c:mount -> r:tmpfs on /tmp type tmpfs && r:noexec"

  # 1.1.6 Ensure separate partition exists for /var (Automated)
  - id: 29500
    title: "Ensure separate partition exists for /var."
    description: "The /var directory is used by daemons and other system services to temporarily store dynamic data. Some directories created by these processes may be world-writable. Note: When modifying /var it is advisable to bring the system to emergency mode (so auditd is not running), rename the existing directory, mount the new file system, and migrate the data over before returning to multiuser mode."
    rationale: "Since the /var directory may contain world-writable files and directories, there is a risk of resource exhaustion if it is not bound to a separate partition."
    impact: "Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for the purpose of resizing operations. The use of these additional tools may introduce their own security considerations."
    remediation: "For new installations, during installation create a custom partition setup and specify a separate partition for /var For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate."
    references:
      - http://tldp.org/HOWTO/LVM-HOWTO/
    compliance:
      - cis: ["1.1.6"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - 'c:mount -> r:\S+ on /var type ext4'

  # 1.1.7 Ensure separate partition exists for /var/tmp (Automated)
  - id: 29500
    title: "Ensure separate partition exists for /var/tmp."
    description: "The /var/tmp directory is a world-writable directory used for temporary storage by all users and some applications."
    rationale: "Since the /var/tmp directory is intended to be world-writable, there is a risk of resource exhaustion if it is not bound to a separate partition. In addition, making /var/tmp its own file system allows an administrator to set the noexec option on the mount, making /var/tmp useless for an attacker to install executable code. It would also prevent an attacker from establishing a hardlink to a system setuid program and wait for it to be updated. Once the program was updated, the hardlink would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw."
    impact: "Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for the purpose of resizing operations. The use of these additional tools may introduce their own security considerations."
    remediation: "For new installations, during installation create a custom partition setup and specify a separate partition for /var/tmp For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate."
    compliance:
      - cis: ["1.1.7"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - 'c:mount -> r:\S+ on /var/tmp type ext4'

  # 1.1.8 Ensure nodev option set on /var/tmp partition (Automated)
  - id: 29500
    title: "Ensure nodev option set on /var/tmp partition."
    description: "The nodev mount option specifies that the filesystem cannot contain special devices."
    rationale: "Since the /var/tmp filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /var/tmp."
    remediation: "Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var/tmp partition. See the fstab(5) manual page for more information. Run the following command to remount /var/tmp : # mount -o remount,nodev /var/tmp."
    compliance:
      - cis: ["1.1.8"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - 'c:mount -> r:\S+ on /var/tmp type ext4 && r:nodev'

  # 1.1.9 Ensure nosuid option set on /var/tmp partition (Automated)
  - id: 29500
    title: "Ensure nosuid option set on /var/tmp partition."
    description: "The nosuid mount option specifies that the filesystem cannot contain setuid files."
    rationale: "Since the /var/tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /var/tmp."
    remediation: "Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var/tmp partition. See the fstab(5) manual page for more information. Run the following command to remount /var/tmp : # mount -o remount,nosuid /var/tmp."
    compliance:
      - cis: ["1.1.9"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - 'c:mount -> r:\S+ on /var/tmp type ext4 && r:nosuid'

  # 1.1.10 Ensure noexec option set on /var/tmp partition (Automated)
  - id: 29500
    title: "Ensure noexec option set on /var/tmp partition."
    description: "The noexec mount option specifies that the filesystem cannot contain executable binaries."
    rationale: "Since the /var/tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /var/tmp."
    remediation: "Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /var/tmp partition. See the fstab(5) manual page for more information. Run the following command to remount /var/tmp: # mount -o remount,noexec /var/tmp."
    compliance:
      - cis: ["1.1.10"]
      - cis_csc_v7: ["2.6"]
      - cmmc_v2.0: ["CM.2.063", "CM.3.069", "CM.4.073"]
      - iso_27001-2013: ["A.12.5.1", "A.12.6.2"]
      - mitre_techniques: ["T1191", "T1092", "T1175", "T1173", "T1519", "T1052", "T1210", "T1133", "T1118", "T1171", "T1170", "T1046", "T1137", "T1086", "T1164", "T1121", "T1076", "T1091", "T1180", "T1064", "T1184", "T1221", "T1127", "T1028"]
      - nist_sp_800-53: ["CM-11"]
    condition: all
    rules:
      - 'c:mount -> r:\S+ on /var/tmp type ext4 && r:noexec'

  # 1.1.11 Ensure separate partition exists for /var/log (Automated)
  - id: 29500
    title: "Ensure separate partition exists for /var/log."
    description: "The /var/log directory is used by system services to store log data. Note: When modifying /var/log it is advisable to bring the system to emergency mode (so auditd is not running), rename the existing directory, mount the new file system, and migrate the data over before returning to multiuser mode."
    rationale: "There are two important reasons to ensure that system logs are stored on a separate partition: protection against resource exhaustion (since logs can grow quite large) and protection of audit data."
    impact: "Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for the purpose of resizing operations. The use of these additional tools may introduce their own security considerations."
    remediation: "For new installations, during installation create a custom partition setup and specify a separate partition for /var/log . For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate."
    references:
      - http://tldp.org/HOWTO/LVM-HOWTO/
    compliance:
      - cis: ["1.1.11"]
      - cis_csc_v7: ["6.4"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-4"]
      - pci_dss_v3.2.1: ["10.7"]
    condition: all
    rules:
      - 'c:mount -> r:\S+ on /var/log type ext4'

  # 1.1.12 Ensure separate partition exists for /var/log/audit (Automated)
  - id: 29500
    title: "Ensure separate partition exists for /var/log/audit."
    description: "The auditing daemon, auditd , stores log data in the /var/log/audit directory. Note: When modifying /var/log/audit it is advisable to bring the system to emergency mode (so auditd is not running), rename the existing directory, mount the new file system, and migrate the data over before returning to multiuser mode."
    rationale: "There are two important reasons to ensure that data gathered by auditd is stored on a separate partition: protection against resource exhaustion (since the audit.log file can grow quite large) and protection of audit data. The audit daemon calculates how much free space is left and performs actions based on the results. If other processes (such as syslog ) consume space in the same partition as auditd , it may not perform as desired."
    impact: "Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for the purpose of resizing operations. The use of these additional tools may introduce their own security considerations."
    remediation: "For new installations, during installation create a custom partition setup and specify a separate partition for /var/log/audit . For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate."
    references:
      - http://tldp.org/HOWTO/LVM-HOWTO/
    compliance:
      - cis: ["1.1.12"]
      - cis_csc_v7: ["6.4"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-4"]
      - pci_dss_v3.2.1: ["10.7"]
    condition: all
    rules:
      - 'c:mount -> r:\S+ on /var/log/audit type ext4'

  # 1.1.13 Ensure separate partition exists for /home (Automated)
  - id: 29500
    title: "Ensure separate partition exists for /home."
    description: "The /home directory is used to support disk storage needs of local users."
    rationale: "If the system is intended to support local users, create a separate partition for the /home directory to protect against resource exhaustion and restrict the type of files that can be stored under /home."
    impact: "Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for the purpose of resizing operations. The use of these additional tools may introduce their own security considerations."
    remediation: "For new installations, during installation create a custom partition setup and specify a separate partition for /home For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate."
    references:
      - http://tldp.org/HOWTO/LVM-HOWTO/
    compliance:
      - cis: ["1.1.13"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "c:mount -> r:/dev/xvdf1 on /home type ext4"

  # 1.1.14 Ensure nodev option set on /home partition (Automated)
  - id: 29500
    title: "Ensure nodev option set on /home partition."
    description: "The nodev mount option specifies that the filesystem cannot contain special devices."
    rationale: "Since the user partitions are not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices."
    remediation: "Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /home partition. See the fstab(5) manual page for more information. # mount -o remount,nodev /home."
    compliance:
      - cis: ["1.1.14"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "c:mount -> r:/dev/xvdf1 on /home type ext4 && r:nodev"

  # 1.1.15 Ensure nodev option set on /dev/shm partition (Automated)
  - id: 29500
    title: "Ensure nodev option set on /dev/shm partition."
    description: "The nodev mount option specifies that the filesystem cannot contain special devices."
    rationale: "Since the /dev/shm filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create special devices in /dev/shm partitions."
    remediation: "Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /dev/shm partition. See the fstab(5) manual page for more information. Run the following command to remount /dev/shm : # mount -o remount,nodev /dev/shm."
    compliance:
      - cis: ["1.1.15"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "c:mount -> r:tmpfs on /dev/shm type tmpfs && r:nodev"

  # 1.1.16 Ensure nosuid option set on /dev/shm partition (Automated)
  - id: 29500
    title: "Ensure nosuid option set on /dev/shm partition."
    description: "The nosuid mount option specifies that the filesystem cannot contain setuid files."
    rationale: "Setting this option on a file system prevents users from introducing privileged programs onto the system and allowing non-root users to execute them."
    remediation: "Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /dev/shm partition. See the fstab(5) manual page for more information. Run the following command to remount /dev/shm : # mount -o remount,nosuid /dev/shm."
    compliance:
      - cis: ["1.1.16"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "c:mount -> r:tmpfs on /dev/shm type tmpfs && r:nosuid"

  # 1.1.17 Ensure noexec option set on /dev/shm partition (Automated)
  - id: 29500
    title: "Ensure noexec option set on /dev/shm partition."
    description: "The noexec mount option specifies that the filesystem cannot contain executable binaries."
    rationale: "Setting this option on a file system prevents users from executing programs from shared memory. This deters users from introducing potentially malicious software on the system."
    remediation: "Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /dev/shm partition. See the fstab(5) manual page for more information. Run the following command to remount /dev/shm: # mount -o remount,noexec /dev/shm."
    compliance:
      - cis: ["1.1.16"]
      - cis_csc_v7: ["2.6"]
      - cmmc_v2.0: ["CM.2.063", "CM.3.069", "CM.4.073"]
      - iso_27001-2013: ["A.12.5.1", "A.12.6.2"]
      - mitre_techniques: ["T1191", "T1092", "T1175", "T1173", "T1519", "T1052", "T1210", "T1133", "T1118", "T1171", "T1170", "T1046", "T1137", "T1086", "T1164", "T1121", "T1076", "T1091", "T1180", "T1064", "T1184", "T1221", "T1127", "T1028"]
      - nist_sp_800-53: ["CM-11"]
    condition: all
    rules:
      - "c:mount -> r:tmpfs on /dev/shm type tmpfs && r:noexec"

  # 1.1.18 Ensure nodev option set on removable media partitions (Manual) - Not Implemented
  # 1.1.19 Ensure nosuid option set on removable media partitions (Manual) - Not Implemented
  # 1.1.20 Ensure noexec option set on removable media partitions (Manual) - Not Implemented
  # 1.1.21 Ensure sticky bit is set on all world-writable directories (Automated) - Not Implemented

  # 1.1.22 Disable Automounting (Automated)
  - id: 29500
    title: "Disable Automounting."
    description: "autofs allows automatic mounting of devices, typically including CD/DVDs and USB drives. Note: This control should align with the tolerance of the use of portable drives and optical media in the organization. On a server requiring an admin to manually mount media can be part of defense-in-depth to reduce the risk of unapproved software or information being introduced or proprietary software or information being exfiltrated. If admins commonly use flash drives and Server access has sufficient physical controls, requiring manual mounting may not increase security."
    rationale: "With automounting enabled anyone with physical access could attach a USB drive or disc and have its contents available in system even if they lacked permissions to mount it themselves."
    impact: "The use of portable hard drives is very common for workstation users. If your organization allows the use of portable storage or media on workstations and physical access controls to workstations is considered adequate there is little value add in turning off automounting."
    remediation: "Run one of the following commands: Run the following command to disable autofs : # systemctl --now disable autofs OR Run the following command to remove autofs # apt purge autofs."
    compliance:
      - cis: ["1.1.22"]
      - cis_csc_v7: ["8.4", "8.5"]
      - cmmc_v2.0: ["SI.1.213"]
      - iso_27001-2013: ["A.12.2.1"]
      - mitre_techniques: ["T1215", "T1027", "T1045", "T1193", "T1194", "T1221", "T1200", "T1091"]
      - nist_sp_800-53: ["SI-3"]
    condition: any
    rules:
      - "c:systemctl is-enabled autofs -> r:disabled"
      - "c:dpkg -s autofs -> r:package 'autofs' is not installed"

  # 1.1.23 Disable USB Storage (Automated)
  - id: 29500
    title: "Disable USB Storage."
    description: "USB storage provides a means to transfer and store files insuring persistence and availability of the files independent of network connection status. Its popularity and utility has led to USB-based malware being a simple and common means for network infiltration and a first step to establishing a persistent threat within a networked environment. Note: An alternative solution to disabling the usb-storage module may be found in USBGuard. Use of USBGuard and construction of USB device policies should be done in alignment with site policy."
    rationale: "Restricting USB access on the system will decrease the physical attack surface for a device and diminish the possible vectors to introduce malware."
    remediation: "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/usb_storage.conf and add the following line: install usb-storage /bin/true Run the following command to unload the usb-storage module: rmmod usb-storage."
    compliance:
      - cis: ["1.1.23"]
      - cis_csc_v7: ["8.4", "8.5"]
      - cmmc_v2.0: ["SI.1.213"]
      - iso_27001-2013: ["A.12.2.1"]
      - mitre_techniques: ["T1215", "T1027", "T1045", "T1193", "T1194", "T1221", "T1200", "T1091"]
      - nist_sp_800-53: ["SI-3"]
    condition: all
    rules:
      - "c:modprobe -n -v usb-storage -> r:install /bin/true"
      - "not c:lsmod -> r:usb-storage"

  ##################################################
  # 1.2 Configure Software Updates
  ##################################################
  # 1.2.1 Ensure package manager repositories are configured (Manual) - Not Implemented
  # 1.2.2 Ensure GPG keys are configured (Manual) - Not Implemented

  ##################################################
  # 1.3 Configure sudo
  ##################################################

  # 1.3.1 Ensure sudo is installed (Automated)
  - id: 29500
    title: "Ensure sudo is installed."
    description: "sudo allows a permitted user to execute a command as the superuser or another user, as specified by the security policy. The invoking user's real (not effective) user ID is used to determine the user name with which to query the security policy. Note: Use the sudo-ldap package if you need LDAP support for sudoers."
    rationale: "sudo supports a plugin architecture for security policies and input/output logging. Third parties can develop and distribute their own policy and I/O logging plugins to work seamlessly with the sudo front end. The default security policy is sudoers, which is configured via the file /etc/sudoers. The security policy determines what privileges, if any, a user has to run sudo. The policy may require that users authenticate themselves with a password or another authentication mechanism. If authentication is required, sudo will exit if the user's password is not entered within a configurable time limit. This limit is policy-specific."
    remediation: "Install sudo using the following command. # apt install sudo OR # apt install sudo-ldap."
    compliance:
      - cis: ["1.3.1"]
      - cis_csc_v7: ["4.3"]
      - cmmc_v2.0: ["AC.2.008", "IA.1.076", "IA.1.077", "SC.3.181"]
      - iso_27001-2013: ["A.9.2.3"]
      - mitre_techniques: ["T1176", "T1501", "T1134", "T1098", "T1017", "T1067", "T1088", "T1175", "T1136", "T1003", "T1214", "T1190", "T1210", "T1495", "T1525", "T1208", "T1215", "T1075", "T1097", "T1086", "T1055", "T1076", "T1053", "T1505", "T1035", "T1051", "T1218", "T1184", "T1169", "T1206", "T1019", "T1072", "T1078", "T1100", "T1077", "T1047", "T1084", "T1028"]
      - pci_dss_v3.2.1: ["7.1", "7.1.1", "7.1.2", "7.1.3"]
    condition: any
    rules:
      - "c:dpkg -s sudo -> r:install ok installed"
      - "c:dpkg -s sudo-ldap -> r:install ok installed"

  # 1.3.2 Ensure sudo commands use pty (Automated)
  - id: 29500
    title: "Ensure sudo commands use pty."
    description: "sudo can be configured to run only from a pseudo-pty Note: visudo edits the sudoers file in a safe fashion, analogous to vipw(8). visudo locks the sudoers file against multiple simultaneous edits, provides basic sanity checks, and checks or parse errors. If the sudoers file is currently being edited you will receive a message to try again later."
    rationale: "Attackers can run a malicious program using sudo, which would again fork a background process that remains even when the main program has finished executing."
    remediation: "Edit the file /etc/sudoers or a file in /etc/sudoers.d/ with visudo -f and add the following line: Defaults use_pty."
    references:
      - http://www.sudo.ws/
    compliance:
      - cis: ["1.3.2"]
      - cis_csc_v7: ["4.3"]
      - cmmc_v2.0: ["AC.2.008", "IA.1.076", "IA.1.077", "SC.3.181"]
      - iso_27001-2013: ["A.9.2.3"]
      - mitre_techniques: ["T1176", "T1501", "T1134", "T1098", "T1017", "T1067", "T1088", "T1175", "T1136", "T1003", "T1214", "T1190", "T1210", "T1495", "T1525", "T1208", "T1215", "T1075", "T1097", "T1086", "T1055", "T1076", "T1053", "T1505", "T1035", "T1051", "T1218", "T1184", "T1169", "T1206", "T1019", "T1072", "T1078", "T1100", "T1077", "T1047", "T1084", "T1028"]
      - pci_dss_v3.2.1: ["7.1", "7.1.1", "7.1.2", "7.1.3"]
    condition: any
    rules:
      - 'f:/etc/sudoers -> r:Defaults\s*\t*use_pty'
      - 'd:/etc/sudoers -> r: \.* -> r:Defaults\s*\t*use_pty'

  # 1.3.3 Ensure sudo log file exists (Automated)
  - id: 29500
    title: "Ensure sudo log file exists."
    description: "sudo can use a custom log file. Note: visudo edits the sudoers file in a safe fashion, analogous to vipw(8). visudo locks the sudoers file against multiple simultaneous edits, provides basic sanity checks, and checks or parse errors. If the sudoers file is currently being edited you will receive a message to try again later."
    rationale: "A sudo log file simplifies auditing of sudo commands."
    remediation: 'Edit the file /etc/sudoers or a file in /etc/sudoers.d/ with visudo -f and add the following line: and add the following line: Defaults logfile="<PATH TO CUSTOM LOG FILE>" Example: Defaults logfile="/var/log/sudo.log".'
    compliance:
      - cis: ["1.3.3"]
      - cis_csc_v7: ["6.3"]
      - cmmc_v2.0: ["CM.2.065"]
      - iso_27001-2013: ["A.12.4.1"]
      - nist_sp_800-53: ["AU-12"]
      - pci_dss_v3.2.1: ["10.1", "10.3"]
    condition: any
    rules:
      - 'f:/etc/sudoers -> r:Defaults\s*\t*logfile=\S+'
      - 'd:/etc/sudoers -> r: \.* -> r:Defaults\s*\t*logfile=\S+'

  ###############################################
  # 1.4 Filesystem Integrity Checking
  ###############################################

  # 1.4.1 Ensure AIDE is installed (Automated)
  - id: 29500
    title: "Ensure AIDE is installed."
    description: "AIDE takes a snapshot of filesystem state including modification times, permissions, and file hashes which can then be used to compare against the current state of the filesystem to detect modifications to the system. Note: The prelinking feature can interfere with AIDE because it alters binaries to speed up their start up times. Run prelink -ua to restore the binaries to their prelinked state, thus avoiding false positives from AIDE."
    rationale: "By monitoring the filesystem state compromised files can be detected to prevent or limit the exposure of accidental or malicious misconfigurations or modified binaries."
    remediation: "Install AIDE using the appropriate package manager or manual installation: # apt install aide aide-common Configure AIDE as appropriate for your environment. Consult the AIDE documentation for options. Initialize AIDE: Run the following commands: # aideinit # mv /var/lib/aide aide.db.new /var/lib/aide/aide.db."
    compliance:
      - cis: ["1.4.1"]
      - cis_csc_v7: ["14.9"]
      - cmmc_v2.0: ["AU.3.050"]
      - iso_27001-2013: ["A.12.4.3"]
      - nist_sp_800-53: ["AU-3"]
      - pci_dss_v3.2.1: ["10.2.1", "11.5"]
    condition: all
    rules:
      - "c:dpkg -s aide -> r:Status: install ok installed"
      - "c:dpkg -s aide-common -> r:Status: install ok installed"

  # 1.4.2 Ensure filesystem integrity is regularly checked (Automated)
  - id: 29500
    title: "Ensure filesystem integrity is regularly checked."
    description: "Periodic checking of the filesystem integrity is needed to detect changes to the filesystem. Notes: - The checking in this recommendation occurs every day at 5am. Alter the frequency and time of the checks in compliance with site policy - systemd timers, timer file aidecheck.timer and service file aidecheck.service, have been included as an optional alternative to using cron - Ubuntu advises using /usr/bin/aide.wrapper rather than calling /usr/bin/aide directly in order to protect the database and prevent conflicts."
    rationale: "Periodic file checking allows the system administrator to determine on a regular basis if critical files have been changed in an unauthorized fashion."
    remediation: "If cron will be used to schedule and run aide check: Run the following command: # crontab -u root -e Add the following line to the crontab: 0 5 * * * /usr/bin/aide.wrapper --config /etc/aide/aide.conf --check OR If aidecheck.service and aidecheck.timer will be used to schedule and run aide check: Create or edit the file /etc/systemd/system/aidecheck.service and add the following lines: [Unit] Description=Aide Check [Service] Type=simple ExecStart=/usr/bin/aide.wrapper --config /etc/aide/aide.conf --check [Install] WantedBy=multi-user.target Create or edit the file /etc/systemd/system/aidecheck.timer and add the following lines: [Unit] Description=Aide check every day at 5AM [Timer] OnCalendar=*-*-* 05:00:00 Unit=aidecheck.service [Install] WantedBy=multi-user.target Run the following commands: # chown root:root /etc/systemd/system/aidecheck.* # chmod 0644 /etc/systemd/system/aidecheck.* # systemctl daemon-reload # systemctl enable aidecheck.service # systemctl --now enable aidecheck.timer."
    reference:
      - https://github.com/konstruktoid/hardening/blob/master/config/aidecheck.service
      - https://github.com/konstruktoid/hardening/blob/master/config/aidecheck.timer
    compliance:
      - cis: ["1.4.2"]
      - cis_csc_v7: ["14.9"]
      - cmmc_v2.0: ["AU.3.050"]
      - iso_27001-2013: ["A.12.4.3"]
      - nist_sp_800-53: ["AU-3"]
      - pci_dss_v3.2.1: ["10.2.1", "11.5"]
    condition: all
    rules:
      - "c:systemctl is-enabled aidecheck.service -> r:enabled"
      - "c:systemctl is-enabled aidecheck.timer -> r:enabled"
      - 'c:systemctl status aidecheck.timer -> r:active\s*\(running\)'

 #########################################
 # 1.5 Secure Boot Settings
 #########################################

  # 1.5.1 Ensure permissions on bootloader config are configured (Automated)
  - id: 29500
    title: "Ensure permissions on bootloader config are configured."
    description: "The grub configuration file contains information on boot settings and passwords for unlocking boot options. Notes: - This recommendation is designed around the grub bootloader, if LILO or another bootloader is in use in your environment enact equivalent settings. - Replace /boot/grub/grub.cfg with the appropriate grub configuration file for your environment."
    rationale: "Setting the permissions to read and write for root only prevents non-root users from seeing the boot parameters or changing them. Non-root users who read the boot parameters may be able to identify weaknesses in security upon boot and be able to exploit them."
    remediation: "Run the following commands to set permissions on your grub configuration: # chown root:root /boot/grub/grub.cfg # chmod og-rwx /boot/grub/grub.cfg."
    compliance:
      - cis: ["1.5.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - 'c:stat /boot/grub/grub.cfg -> r:Access:\s*\(0400/-r--------\)\s*Uid:\s*\(\s*\t*0/\s*\t*root\)\s*\t*Gid:\s*\(\s*\t*0/\s*\t*root\)'

  # 1.5.2 Ensure bootloader password is set (Automated)
  - id: 29528
    title: "Ensure bootloader password is set."
    description: "Setting the boot loader password will require that anyone rebooting the system must enter a password before being able to set command line boot parameters. Notes: - This recommendation is designed around the grub bootloader, if LILO or another bootloader is in use in your environment enact equivalent settings. - Replace /boot/grub/grub.cfg with the appropriate grub configuration file for your environment."
    rationale: "Requiring a boot password upon execution of the boot loader will prevent an unauthorized user from entering boot parameters or changing the boot partition. This prevents users from weakening security (e.g. turning off AppArmor at boot time)."
    impact: "If password protection is enabled, only the designated superuser can edit a Grub 2 menu item by pressing 'e' or access the GRUB 2 command line by pressing 'c' If GRUB 2 is set up to boot automatically to a password-protected menu entry the user has no option to back out of the password prompt to select another menu entry. Holding the SHIFT key will not display the menu in this case. The user must enter the correct username and password. If unable, the configuration files will have to be edited via the LiveCD or other means to fix the problem You can add --unrestricted to the menu entries to allow the system to boot without entering a password. Password will still be required to edit menu items. More Information: https://help.ubuntu.com/community/Grub2/Passwords."
    remediation: 'Create an encrypted password with grub-mkpasswd-pbkdf2: # grub-mkpasswd-pbkdf2 Enter password: <password> Reenter password: <password> PBKDF2 hash of your password is <encrypted-password>. Add the following into a custom /etc/grub.d configuration file: cat <<EOF set superusers="<username>" password_pbkdf2 <username> <encrypted-password> EOF. The superuser/user information and password should not be contained in the /etc/grub.d/00_header file as this file could be overwritten in a package update. If there is a requirement to be able to boot/reboot without entering the password, edit /etc/grub.d/10_linux and add --unrestricted to the line CLASS= Example: CLASS="--class gnu-linux --class gnu --class os --unrestricted". Run the following command to update the grub2 configuration: # update-grub.'
    references:
      - https://help.ubuntu.com/community/Grub2/Passwords
    compliance:
      - cis: ["1.5.2"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - 'f:/boot/grub/grub.cfg -> r:^\s*\t*set superusers'
      - 'f:/boot/grub/grub.cfg -> r:^\s*\t*password'

  # 1.5.3 Ensure authentication required for single user mode (Automated)
  - id: 29530
    title: "Ensure authentication required for single user mode."
    description: "Single user mode is used for recovery when the system detects an issue during boot or by manual selection from the bootloader."
    rationale: "Requiring authentication in single user mode prevents an unauthorized user from rebooting the system into single user to gain root privileges without credentials."
    remediation: "Run the following command and follow the prompts to set a password for the root user: # passwd root."
    compliance:
      - cis: ["1.5.3"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - 'f:/etc/shadow -> r:^root:\$\w'

 #############################################
 # 1.6 Additional Process Hardening
 #############################################

  # 1.6.1 Ensure XD/NX support is enabled (Automated)
  - id: 29530
    title: "Ensure XD/NX support is enabled."
    description: "Recent processors in the x86 family support the ability to prevent code execution on a per memory page basis. Generically and on AMD processors, this ability is called No Execute (NX), while on Intel processors it is called Execute Disable (XD). This ability can help prevent exploitation of buffer overflow vulnerabilities and should be activated whenever possible. Extra steps must be taken to ensure that this protection is enabled, particularly on 32-bit x86 systems. Other processors, such as Itanium and POWER, have included such support since inception and the standard kernel for those platforms supports the feature. Note: Ensure your system supports the XD or NX bit and has PAE support before implementing this recommendation as this may prevent it from booting if these are not supported by your hardware."
    rationale: "Enabling any feature that can protect against buffer overflow attacks enhances the security of the system."
    remediation: "On 32 bit systems install a kernel with PAE support, no installation is required on 64 bit systems: If necessary configure your bootloader to load the new kernel and reboot the system. You may need to enable NX or XD support in your bios."
    compliance:
      - cis: ["1.6.1"]
      - cis_csc_v7: ["8.3"]
      - mitre_techniques: ["T1189", "T1190", "T1203", "T1212", "T1211", "T1068", "T1210", "T1117", "T1085", "T1080", "T1131", "T1003", "T1101"]
      - nist_sp_800-53: ["SC-39", "SI-16"]
    condition: all
    rules:
      - 'c:journalctl -> r:protection: active'

  # 1.6.2 Ensure address space layout randomization (ASLR) is enabled (Automated)
  - id: 29530
    title: "Ensure address space layout randomization (ASLR) is enabled."
    description: "Address space layout randomization (ASLR) is an exploit mitigation technique which randomly arranges the address space of key data areas of a process."
    rationale: "Randomly placing virtual memory regions will make it difficult to write memory page exploits as the memory placement will be consistently shifting."
    remediation: "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: kernel.randomize_va_space = 2 Run the following command to set the active kernel parameter: # sysctl -w kernel.randomize_va_space=2."
    compliance:
      - cis: ["1.6.2"]
      - cis_csc_v7: ["8.3"]
      - mitre_techniques: ["T1189", "T1190", "T1203", "T1212", "T1211", "T1068", "T1210", "T1117", "T1085", "T1080", "T1131", "T1003", "T1101"]
      - nist_sp_800-53: ["SC-39", "SI-16"]
    condition: any
    rules:
      - 'c:sysctl kernel.randomize_va_space -> r:kernel.randomize_va_space = 2'
      - 'f:/etc/sysctl.conf -> r:kernel.randomize_va_space = 2'
      - 'd:/etc/sysctl.d/ -> r:\.* -> r:kernel.randomize_va_space = 2'

  # 1.6.3 Ensure prelink is disabled (Automated)
  - id: 29530
    title: "Ensure prelink is disabled."
    description: "prelink is a program that modifies ELF shared libraries and ELF dynamically linked binaries in such a way that the time needed for the dynamic linker to perform relocations at startup significantly decreases."
    rationale: "The prelinking feature can interfere with the operation of AIDE, because it changes binaries. Prelinking can also increase the vulnerability of the system if a malicious user is able to compromise a common library such as libc."
    remediation: "Run the following command to restore binaries to normal: # prelink -ua Uninstall prelink using the appropriate package manager or manual installation: # apt purge prelink."
    compliance:
      - cis: ["1.6.3"]
      - cis_csc_v7: ["14.9"]
      - cmmc_v2.0: ["AU.3.050"]
      - iso_27001-2013: ["A.12.4.3"]
      - nist_sp_800-53: ["AU-3"]
      - pci_dss_v3.2.1: ["10.2.1", "11.5"]
    condition: all
    rules:
      - "c:dpkg -s prelink -> r:package 'prelink' is not installed"

  # 1.6.4 Ensure prelink is disabled (Automated)
  - id: 29530
    title: "Ensure prelink is disabled."
    description: "A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also be used to glean confidential information from a core file. The system provides the ability to set a soft limit for core dumps, but this can be overridden by the user."
    rationale: "Setting a hard limit on core dumps prevents users from overriding the soft variable. If core dumps are required, consider setting limits for user groups (see limits.conf(5) ). In addition, setting the fs.suid_dumpable variable to 0 will prevent setuid programs from dumping core."
    remediation: "Add the following line to /etc/security/limits.conf or a /etc/security/limits.d/* file: * hard core 0 Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: fs.suid_dumpable = 0 Run the following command to set the active kernel parameter: # sysctl -w fs.suid_dumpable=0 If systemd-coredump is installed: edit /etc/systemd/coredump.conf and add/modify the following lines: Storage=none ProcessSizeMax=0 Run the command: systemctl daemon-reload."
    compliance:
      - cis: ["1.6.4"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - "f:/etc/security/limits.conf -> r:* hard core 0"
      - 'c:sysctl fs.suid_dumpable -> r:fs.suid_dumpable = 0'
      - 'f:/etc/sysctl.conf -> r:fs.suid_dumpable = 0'
      - 'd:/etc/sysctl.d/* -> r:\.* -> r:fs.suid_dumpable = 0'
      - 'c:systemctl is-enabled coredump.service -> r:enabled|masked|disabled'

 ##############################################
 # 1.7 Mandatory Access Control
 ##############################################
 # 1.7.1 Configure AppArmor
 ##############################################

  # 1.7.1.1 Ensure AppArmor is installed (Automated)
  - id: 29530
    title: "Ensure AppArmor is installed."
    description: "AppArmor provides Mandatory Access Controls."
    rationale: "Without a Mandatory Access Control system installed only the default Discretionary Access Control system will be available."
    remediation: "Add the following line to /etc/security/limits.conf or a /etc/security/limits.d/* file: * hard core 0 Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: fs.suid_dumpable = 0 Run the following command to set the active kernel parameter: # sysctl -w fs.suid_dumpable=0 If systemd-coredump is installed: edit /etc/systemd/coredump.conf and add/modify the following lines: Storage=none ProcessSizeMax=0 Run the command: systemctl daemon-reload."
    compliance:
      - cis: ["1.7.1.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - 'c:dpkg -s apparmor -> r:install ok installed'

  # 1.7.1.2 Ensure AppArmor is enabled in the bootloader configuration (Automated)
  - id: 29530
    title: "Ensure AppArmor is enabled in the bootloader configuration."
    description: "Configure AppArmor to be enabled at boot time and verify that it has not been overwritten by the bootloader boot parameters. Note: This recommendation is designed around the grub bootloader, if LILO or another bootloader is in use in your environment enact equivalent settings."
    rationale: "AppArmor must be enabled at boot time in your bootloader configuration to ensure that the controls it provides are not overridden."
    remediation: "Edit /etc/default/grub and add the apparmor=1 and security=apparmor parameters to the GRUB_CMDLINE_LINUX= line GRUB_CMDLINE_LINUX=\"apparmor=1 security=apparmor\" Run the following command to update the grub2 configuration: # update-grub."
    compliance:
      - cis: ["1.7.1.2"]
      - cis_csc_v7: ["14.6"]
      - cmmc_v2.0: ["AC.2.007", "MP.2.120"]
      - iso_27001-2013: ["A.9.1.1"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051", "T1156", "T1146", "T1196", "T1081", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1145", "T1494", "T1035", "T1489", "T1198", "T1184", "T1165", "T1492", "T1169", "T1501", "T1080", "T1209", "T1134", "T1197", "T1538", "T1213", "T1044", "T1484", "T1159", "T1160", "T1152", "T1168", "T1162", "T1185", "T1031", "T1050", "T1075", "T1097", "T1163", "T1021", "T1053", "T1023", "T1528", "T1072", "T1537", "T1078", "T1047", "T1084", "T1004"]
      - nist_sp_800-53: ["AC-3"]
      - pci_dss_v3.2.1: ["7.1", "7.1.1", "7.1.2", "7.1.3"]
    condition: all
    rules:
      - 'f:/boot/grub/grub.cfg -> r:apparmor=1'
      - 'f:/boot/grub/grub.cfg -> r:security=apparmor'

  # 1.7.1.3 Ensure all AppArmor Profiles are in enforce or complain mode (Automated)
  - id: 29530
    title: "Ensure all AppArmor Profiles are in enforce or complain mode."
    description: "AppArmor profiles define what resources applications are able to access."
    rationale: "Security configuration requirements vary from site to site. Some sites may mandate a policy that is stricter than the default policy, which is perfectly acceptable. This item is intended to ensure that any policies that exist on the system are activated."
    remediation: "Run the following command to set all profiles to enforce mode: # aa-enforce /etc/apparmor.d/* OR Run the following command to set all profiles to complain mode: # aa-complain /etc/apparmor.d/* Note: Any unconfined processes may need to have a profile created or activated for them and then be restarted."
    compliance:
      - cis: ["1.7.1.3"]
      - cis_csc_v7: ["14.6"]
      - cmmc_v2.0: ["AC.2.007", "MP.2.120"]
      - iso_27001-2013: ["A.9.1.1"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051", "T1156", "T1146", "T1196", "T1081", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1145", "T1494", "T1035", "T1489", "T1198", "T1184", "T1165", "T1492", "T1169", "T1501", "T1080", "T1209", "T1134", "T1197", "T1538", "T1213", "T1044", "T1484", "T1159", "T1160", "T1152", "T1168", "T1162", "T1185", "T1031", "T1050", "T1075", "T1097", "T1163", "T1021", "T1053", "T1023", "T1528", "T1072", "T1537", "T1078", "T1047", "T1084", "T1004"]
      - nist_sp_800-53: ["AC-3"]
      - pci_dss_v3.2.1: ["7.1", "7.1.1", "7.1.2", "7.1.3"]
    condition: all
    rules:
      - 'c:apparmor_status -> r:\d+ profiles are loaded || \d+ profiles are in enforce mode || \d+ profiles are in complain mode'
      - 'c:apparmor_status -> r:^0\s*processes are unconfined'

  # 1.7.1.4 Ensure all AppArmor Profiles are enforcing (Automated)
  - id: 29530
    title: "Ensure all AppArmor Profiles are enforcing."
    description: "AppArmor profiles define what resources applications are able to access."
    rationale: "Security configuration requirements vary from site to site. Some sites may mandate a policy that is stricter than the default policy, which is perfectly acceptable. This item is intended to ensure that any policies that exist on the system are activated."
    remediation: "Run the following command to set all profiles to enforce mode: # aa-enforce /etc/apparmor.d/* Note: Any unconfined processes may need to have a profile created or activated for them and then be restarted."
    compliance:
      - cis: ["1.7.1.4"]
      - cis_csc_v7: ["14.6"]
      - cmmc_v2.0: ["AC.2.007", "MP.2.120"]
      - iso_27001-2013: ["A.9.1.1"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051", "T1156", "T1146", "T1196", "T1081", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1145", "T1494", "T1035", "T1489", "T1198", "T1184", "T1165", "T1492", "T1169", "T1501", "T1080", "T1209", "T1134", "T1197", "T1538", "T1213", "T1044", "T1484", "T1159", "T1160", "T1152", "T1168", "T1162", "T1185", "T1031", "T1050", "T1075", "T1097", "T1163", "T1021", "T1053", "T1023", "T1528", "T1072", "T1537", "T1078", "T1047", "T1084", "T1004"]
      - nist_sp_800-53: ["AC-3"]
      - pci_dss_v3.2.1: ["7.1", "7.1.1", "7.1.2", "7.1.3"]
    condition: all
    rules:
      - 'c:apparmor_status -> n:^(\d+)\s*profiles are loaded compare > 0'
      - 'c:apparmor_status -> r:^0\s*profiles are in complain mode'
      - 'c:apparmor_status -> r:^0\s*processes are unconfined'

 ########################################
 # 1.8 Warning Banners
 ########################################

   # 1.8.1 Ensure message of the day is configured properly (Automated)
  - id: 29530
    title: "Ensure message of the day is configured properly."
    description: "The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users. Unix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: \\m - machine architecture \\r - operating system release \\s - operating system name \\v - operating system version."
    rationale: "Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Displaying OS and patch level information in login banners also has the side effect of providing detailed system information to attackers attempting to target specific exploits of a system. Authorized users can easily get this information by running the \" uname -a \" command once they have logged in."
    remediation: "Edit the /etc/motd file with the appropriate contents according to your site policy, remove any instances of \\m , \\r , \\s , \\v or references to the OS platform OR If the motd is not used, this file can be removed. Run the following command to remove the motd file: # rm /etc/motd."
    compliance:
      - cis: ["1.8.1"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: any
    rules:
      - "not f:/etc/motd"
      - 'not f:/etc/motd -> r:\\v|\\r|\\m|\\s|Debian'

   # 1.8.2 Ensure permissions on /etc/issue.net are configured (Automated)
  - id: 29530
    title: "Ensure permissions on /etc/issue.net are configured."
    description: "The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services."
    rationale: "If the /etc/issue.net file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information."
    remediation: "Run the following commands to set permissions on /etc/issue.net : # chown root:root /etc/issue.net # chmod u-x,go-wx /etc/issue.net."
    compliance:
      - cis: ["1.8.2"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - 'c:stat /etc/issue.net -> r:Access:\s*\(0644/-rw-r--r--\)\s*Uid:\s*\(\s*\t*0/\s*\t*root\)\s*\t*Gid:\s*\(\s*\t*0/\s*\t*root\)'

   # 1.8.3 Ensure permissions on /etc/issue are configured (Automated)
  - id: 29530
    title: "Ensure permissions on /etc/issue are configured."
    description: "The contents of the /etc/issue file are displayed to users prior to login for local terminals."
    rationale: "If the /etc/issue file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information."
    remediation: "Run the following commands to set permissions on /etc/issue : # chown root:root /etc/issue # chmod u-x,go-wx /etc/issue."
    compliance:
      - cis: ["1.8.3"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - 'c:stat /etc/issue -> r:Access:\s*\(0644/-rw-r--r--\)\s*Uid:\s*\(\s*\t*0/\s*\t*root\)\s*\t*Gid:\s*\(\s*\t*0/\s*\t*root\)'

   # 1.8.4 Ensure permissions on /etc/motd are configured (Automated)
  - id: 29530
    title: "Ensure permissions on /etc/motd are configured."
    description: "The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users. Note: If Message of the day is not needing, this file can be removed."
    rationale: "If the /etc/motd file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information."
    remediation: "Run the following commands to set permissions on /etc/motd : # chown root:root /etc/motd # chmod u-x,go-wx /etc/motd OR Run the following command to remove the /etc/motd file: # rm /etc/motd."
    compliance:
      - cis: ["1.8.4"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: any
    rules:
      - "not f:/etc/motd"
      - 'c:stat -L /etc/motd -> r:Access:\s*\(0644/-rw-r--r--\)\s*Uid:\s*\(\s*\t*0/\s*\t*root\)\s*\t*Gid:\s*\(\s*\t*0/\s*\t*root\)'

   # 1.8.5 Ensure remote login warning banner is configured properly (Automated)
  - id: 29530
    title: "Ensure remote login warning banner is configured properly."
    description: "The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services. Unix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: \\m - machine architecture \\r - operating system release \\s - operating system name \\v - operating system version."
    rationale: "Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Displaying OS and patch level information in login banners also has the side effect of providing detailed system information to attackers attempting to target specific exploits of a system. Authorized users can easily get this information by running the \" uname -a \" command once they have logged in."
    remediation: "Edit the /etc/issue.net file with the appropriate contents according to your site policy, remove any instances of \\m , \\r , \\s , \\v or references to the OS platform # echo \"Authorized uses only. All activity may be monitored and reported.\" > /etc/issue.net."
    compliance:
      - cis: ["1.8.5"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: none
    rules:
      - 'f:/etc/issue.net -> r:\\v|\\r|\\m|\\s|Debian'

   # 1.8.6 Ensure local login warning banner is configured properly (Automated)
  - id: 29530
    title: "Ensure local login warning banner is configured properly."
    description: "The contents of the /etc/issue file are displayed to users prior to login for local terminals. Unix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: \\m - machine architecture \\r - operating system release \\s - operating system name \\v - operating system version - or the operating system's name."
    rationale: "Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Displaying OS and patch level information in login banners also has the side effect of providing detailed system information to attackers attempting to target specific exploits of a system. Authorized users can easily get this information by running the \" uname -a \" command once they have logged in."
    remediation: "Edit the /etc/issue file with the appropriate contents according to your site policy, remove any instances of \\m , \\r , \\s , \\v or references to the OS platform # echo \"Authorized uses only. All activity may be monitored and reported.\" > /etc/issue."
    compliance:
      - cis: ["1.8.6"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: none
    rules:
      - 'f:/etc/issue -> r:\\v|\\r|\\m|\\s|Debian'

   # 1.9 Ensure GDM is removed or login is configured (Automated)
  - id: 29530
    title: "Ensure GDM is removed or login is configured."
    description: "GDM is the GNOME Display Manager which handles graphical login for GNOME based systems."
    rationale: "If a graphical login is not required, it should be removed to reduce the attack surface of the system. If a graphical login is required, last logged in user display should be disabled, and a warning banner should be configured. displaying the last logged in user eliminates half of the Userid/Password equation that an unauthorized person would need to log on. Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Note: If a different GUI login service is in use and required on the system, consult your documentation to disable displaying the last logged on user and apply an equivalent banner."
    remediation: "Edit or create the file /etc/gdm3/greeter.dconf-defaults and edit or add the following: [org/gnome/login-screen] banner-message-enable=true banner-message-text='<banner message>' disable-user-list=true Example banner message: Authorized uses only. All activity may be monitored and reported. Run the following command to re-load GDM on the next login or reboot: # dpkg-reconfigure gdm3."
    compliance:
      - cis: ["1.9"]
      - cis_csc_v7: ["5.1"]
      - cmmc_v2.0: ["AC.1.002", "CM.2.061", "SC.3.180"]
      - iso_27001-2013: ["A.8.1.3", "A.14.2.5"]
      - mitre_techniques: ["T1110", "T1003", "T1081", "T1097", "T1178", "T1072", "T1067", "T1495", "T1019", "T1177", "T1485", "T1486", "T1491", "T1488", "T1487", "T1490", "T1146", "T1148", "T1015", "T1133", "T1200", "T1076", "T1051", "T1176", "T1501", "T1087", "T1098", "T1139", "T1197", "T1092", "T1136", "T1011", "T1147", "T1130", "T1174", "T1053", "T1166", "T1206", "T1503", "T1214", "T1187", "T1208", "T1142", "T1075", "T1201", "T1145", "T1184", "T1537", "T1078", "T1077", "T1134", "T1017", "T1088", "T1175", "T1190", "T1210", "T1525", "T1215", "T1086", "T1055", "T1505", "T1035", "T1218", "T1169", "T1100", "T1047", "T1084", "T1028", "T1156", "T1196", "T1530", "T1089", "T1073", "T1157", "T1054", "T1070", "T1037", "T1036", "T1096", "T1034", "T1150", "T1504", "T1494", "T1489", "T1198", "T1165", "T1492", "T1080", "T1209", "T1112", "T1058", "T1173", "T1137", "T1539", "T1535", "T1506", "T1138", "T1044", "T1199"]
      - nist_sp_800-53: ["AU-2", "CM-1", "CM-2", "CM-6", "CM-7", "IA-5", "IA-6", "SC-20", "SC-21"]
      - pci_dss_v3.2.1: ["2.2"]
    condition: all
    rules:
      - 'c:dpkg -s GDM -> r:install ok installed'
      - 'f:/etc/gdm3/greeter.dconf-defaults -> r:banner-message-enable=true | banner-message-text=\S+ | disable-user-list=true'

   # 1.10 Ensure updates, patches, and additional security software are installed (Manual)
  - id: 29530
    title: "Ensure updates, patches, and additional security software are installed."
    description: "Periodically patches are released for included software either due to security flaws or to include additional functionality. Notes: - Site policy may mandate a testing period before install onto production systems for available updates. - upgrade - is used to install the newest versions of all packages currently installed on the system from the sources enumerated in /etc/apt/sources.list. Packages currently installed with new versions available are retrieved and upgraded; under no circumstances are currently installed packages removed, or packages not already installed retrieved and installed. New versions of currently installed packages that cannot be upgraded without changing the install status of another package will be left at their current version. An update must be performed first so that apt knows that new versions of packages are available. - dist-upgrade - in addition to performing the function of upgrade, also intelligently handles changing dependencies with new versions of packages; apt has a \"smart\" conflict resolution system, and it will attempt to upgrade the most important packages at the expense of less important ones if necessary. So, dist-upgrade command may remove some packages. The /etc/apt/sources.list file contains a list of locations from which to retrieve desired package files. See also apt_preferences(5) for a mechanism for overriding the general settings for individual packages."
    rationale: "Newer patches may contain security enhancements that would not be available through the latest full update. As a result, it is recommended that the latest software patches be used to take advantage of the latest functionality. As with any software installation, organizations need to determine if a given update meets their requirements and verify the compatibility and supportability of any additional software against the update revision that is selected."
    remediation: "Run the following command to update all packages following local site policy guidance on applying updates and patches: # apt upgrade OR # apt dist-upgrade."
    compliance:
      - cis: ["1.10"]
      - cis_csc_v7: ["3.4","3.5"]
      - cmmc_v2.0: ["MA.2.111"]
      - mitre_techniques: ["T1527", "T1176", "T1088", "T1081", "T1214", "T1530", "T1213", "T1038", "T1073", "T1482", "T1114", "T1044", "T1484", "T1525", "T1161", "T1031", "T1034", "T1145", "T1076", "T1053", "T1505", "T1528", "T1078", "T1103", "T1017", "T1138", "T1189", "T1190", "T1212", "T1211", "T1068", "T1210", "T1495", "T1137", "T1075", "T1195", "T1019", "T1072", "T1100"]
    condition: none
    rules:
      - "c:apt -s upgrade -> r:^The following packages will be upgraded"

 ###################################
 # 2 Services
 ###################################
 # 2.1 Special Purpose Services
 ###################################
 # 2.1.1 Time Synchronization
 ###################################

   # 2.1.1.1 Ensure time synchronization is in use (Automated)
  - id: 29530
    title: "Ensure time synchronization is in use."
    description: "System time should be synchronized between all systems in an environment. This is typically done by establishing an authoritative time server or set of servers and having all systems synchronize their clocks to them. Notes: - If access to a physical host's clock is available and configured according to site policy, this section can be skipped - Only one time synchronization method should be in use on the system - If access to a physical host's clock is available and configured according to site policy, systemd-timesyncd should be stopped and masked."
    rationale: "Time synchronization is important to support time sensitive security mechanisms like Kerberos and also ensures log files have consistent time records across the enterprise, which aids in forensic investigations."
    remediation: "Run the following command to update all packages following local site policy guidance on applying updates and patches: # apt upgrade OR # apt dist-upgrade."
    compliance:
      - cis: ["2.1.1.1"]
      - cis_csc_v7: ["6.1"]
      - cmmc_v2.0: ["AU.2.043"]
      - iso_27001-2013: ["A.12.4.4"]
      - nist_sp_800-53: ["AU-8"]
      - pci_dss_v3.2.1: ["10.4"]
    condition: any
    rules:
      - "c:systemctl is-enabled systemd-timesyncd -> r:enabled"
      - "c:dpkg -s chrony -> r:install ok installed"
      - "c:dpkg -s ntp -> r:install ok installed"

   # 2.1.1.2 Ensure systemd-timesyncd is configured (Manual)
  - id: 29530
    title: "Ensure systemd-timesyncd is configured."
    description: "systemd-timesyncd is a daemon that has been added for synchronizing the system clock across the network. It implements an SNTP client. In contrast to NTP implementations such as chrony or the NTP reference server this only implements a client side, and does not bother with the full NTP complexity, focusing only on querying time from one remote server and synchronizing the local clock to it. The daemon runs with minimal privileges, and has been hooked up with networkd to only operate when network connectivity is available. The daemon saves the current clock to disk every time a new NTP sync has been acquired, and uses this to possibly correct the system clock early at bootup, in order to accommodate for systems that lack an RTC such as the Raspberry Pi and embedded devices, and make sure that time monotonically progresses on these systems, even if it is not always correct. To make use of this daemon a new system user and group \"systemd-timesync\" needs to be created on installation of systemd. Notes: - The systemd-timesyncd service specifically implements only SNTP. This minimalistic service will set the system clock for large offsets or slowly adjust it for smaller deltas. More complex use cases are not covered by systemd-timesyncd - If chrony or ntp are used, systemd-timesyncd should be stopped and masked, and this section skipped - This recommendation only applies if timesyncd is in use on the system - Only one time synchronization method should be in use on the system."
    rationale: "Proper configuration is vital to ensuring time synchronization is working properly."
    remediation: "- Remove additional time synchronization methods: Run the following commands to remove ntp and chrony: # apt purge ntp # apt purge chrony - Configure systemd-timesyncd: Run the following command to enable systemd-timesyncd # systemctl enable systemd-timesyncd.service edit the file /etc/systemd/timesyncd.conf and add/modify the following lines: NTP=0.debian.pool.ntp.org 1.debian.pool.ntp.org #Servers listed should be In Accordence With Local Policy FallbackNTP=2.debian.pool.ntp.org 3.debian.pool.ntp.org #Servers listed should be In Accordence With Local Policy RootDistanceMax=1 #should be In Accordence With Local Policy Run the following commands to start systemd-timesyncd.service # systemctl start systemd-timesyncd.service # timedatectl set-ntp true."
    compliance:
      - cis: ["2.1.1.2"]
      - cis_csc_v7: ["6.1"]
      - cmmc_v2.0: ["AU.2.043"]
      - iso_27001-2013: ["A.12.4.4"]
      - nist_sp_800-53: ["AU-8"]
      - pci_dss_v3.2.1: ["10.4"]
    condition: any
    rules:
      - "c:dpkg -s ntp -> r:package 'ntp' is not installed"
      - "c:dpkg -s chrony -> r:package 'chrony' is not installed"
      - "c:systemctl is-enabled systemd-timesyncd.service -> r:enabled"
      - "c:timedatectl status -> r:NTP enabled: yes | NTP synchronized: yes"

   # 2.1.1.3 Ensure chrony is configured (Automated)
  - id: 29530
    title: "Ensure chrony is configured."
    description: "chrony is a daemon which implements the Network Time Protocol (NTP) and is designed to synchronize system clocks across a variety of systems and use a source that is highly accurate. More information on chrony can be found at: http://chrony.tuxfamily.org/. chrony can be configured to be a client and/or a server. Notes: - If ntp or systemd-timesyncd are used, chrony should be removed and this section skipped - This recommendation only applies if chrony is in use on the system - Only one time synchronization method should be in use on the system."
    rationale: "If chrony is in use on the system proper configuration is vital to ensuring time synchronization is working properly."
    remediation: "Remove and/or disable additional time synchronization methods: Run the following command to remove ntp: # apt purge ntp Run the following command to stop and mask systemd-timesyncd: # systemctl --now mask systemd-timesyncd Configure chrony: Add or edit server or pool lines to /etc/chrony/chrony.conf as appropriate: server <remote-server> Add or edit the user line to /etc/chrony/chrony.conf: user _chrony."
    compliance:
      - cis: ["2.1.1.3"]
      - cis_csc_v7: ["6.1"]
      - cmmc_v2.0: ["AU.2.043"]
      - iso_27001-2013: ["A.12.4.4"]
      - nist_sp_800-53: ["AU-8"]
      - pci_dss_v3.2.1: ["10.4"]
    condition: all
    rules:
      - "c:dpkg -s ntp -> r:package 'ntp' is not installed"
      - "c:systemctl is-enabled systemd-timesyncd -> r:masked"
      - 'f:/etc/chrony/chrony.conf -> r:server\s*\S+'
      - 'c:ps -ef -> r:_chrony'

   # 2.1.1.4 Ensure ntp is configured (Automated)
  - id: 29530
    title: "Ensure ntp is configured."
    description: "ntp is a daemon which implements the Network Time Protocol (NTP). It is designed to synchronize system clocks across a variety of systems and use a source that is highly accurate. More information on NTP can be found at http://www.ntp.org. ntp can be configured to be a client and/or a server. Notes: - If chrony or systemd-timesyncd are used, ntp should be removed and this section skipped - This recommendation only applies if ntp is in use on the system - Only one time synchronization method should be in use on the system."
    rationale: "If ntp is in use on the system proper configuration is vital to ensuring time synchronization is working properly."
    remediation: "- Remove and/or disable additional time synchronization methods: Run the following command to remove chrony: apt purge chrony Run the following command to stop and mask systemd-timesyncd: # systemctl --now mask systemd-timesyncd - Configure ntp: Add or edit restrict lines in /etc/ntp.conf to match the following: restrict -4 default kod nomodify notrap nopeer noquery restrict -6 default kod nomodify notrap nopeer noquery Add or edit server or pool lines to /etc/ntp.conf as appropriate: server <remote-server> Configure ntp to run as the ntp user by adding or editing the /etc/init.d/ntp file: RUNASUSER=ntp."
    compliance:
      - cis: ["2.1.1.4"]
      - cis_csc_v7: ["6.1"]
      - cmmc_v2.0: ["AU.2.043"]
      - iso_27001-2013: ["A.12.4.4"]
      - nist_sp_800-53: ["AU-8"]
      - pci_dss_v3.2.1: ["10.4"]
    condition: all
    rules:
      - "c:dpkg -s chrony -> r:package 'ntp' is not installed"
      - "c:systemctl is-enabled systemd-timesyncd -> r:masked"
      - 'f:/etc/ntp.conf -> r:restrict -(d+) && r:default && r:kod && r:nomodify && r:notrap && r:nopeer && r:noquery'
      - 'f:/etc/ntp.conf -> r:restrict -6 && r:default && r:kod && r:nomodify && r:notrap && r:nopeer && r:noquery'
      - 'f:/etc/ntp.conf -> r:server\s*\S+'
      - 'f:/etc/init.d/ntp -> r:RUNASUSER=ntp'

   # 2.1.2 Ensure X Window System is not installed (Automated)
  - id: 29530
    title: "Ensure X Window System is not installed."
    description: "The X Window System provides a Graphical User Interface (GUI) where users can have multiple windows in which to run programs and various add on. The X Windows system is typically used on workstations where users login, but not on servers where users typically do not login."
    rationale: "Unless your organization specifically requires graphical login access via X Windows, remove it to reduce the potential attack surface."
    impact: "Many Linux systems run applications which require a Java runtime. Some Linux Java packages have a dependency on specific X Windows xorg-x11-fonts. One workaround to avoid this dependency is to use the \"headless\" Java packages for your specific Java runtime, if provided by your distribution."
    remediation: "Remove the X Windows System packages: apt purge xserver-xorg*."
    compliance:
      - cis: ["2.1.2"]
      - cis_csc_v7: ["2.6"]
      - cmmc_v2.0: ["CM.2.063", "CM.3.069", "CM.4.073"]
      - iso_27001-2013: ["A.12.5.1", "A.12.6.2"]
      - mitre_techniques: ["T1191", "T1092", "T1175", "T1173", "T1519", "T1052", "T1210", "T1133", "T1118", "T1171", "T1170", "T1046", "T1137", "T1086", "T1164", "T1121", "T1076", "T1091", "T1180", "T1064", "T1184", "T1221", "T1127", "T1028"]
      - nist_sp_800-53: ["CM-11"]
    condition: none
    rules:
      - 'c:dpkg -l xserver-xorg* -> r:^\w\s*xserver-xorg'

   # 2.1.3 Ensure Avahi Server is not installed (Automated)
  - id: 29530
    title: "Ensure Avahi Server is not installed."
    description: "Avahi is a free zeroconf implementation, including a system for multicast DNS/DNS-SD service discovery. Avahi allows programs to publish and discover services and hosts running on a local network with no specific configuration. For example, a user can plug a computer into a network and Avahi automatically finds printers to print to, files to look at and people to talk to, as well as network services running on the machine."
    rationale: "Automatic discovery of network services is not normally required for system functionality. It is recommended to remove this package to reduce the potential attack surface."
    remediation: "Run the following commands to remove avahi-daemon: # systemctl stop avahi-daaemon.service # systemctl stop avahi-daemon.socket # apt purge avahi-daemon."
    compliance:
      - cis: ["2.1.3"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s avahi-daemon -> r:package 'avahi-daemon' is not installed"

   # 2.1.4 Ensure CUPS is not installed (Automated)
  - id: 29530
    title: "Ensure CUPS is not installed."
    description: "The Common Unix Print System (CUPS) provides the ability to print to both local and network printers. A system running CUPS can also accept print jobs from remote systems and print them to local printers. It also provides a web based remote administration capability."
    rationale: "If the system does not need to print jobs or accept print jobs from other systems, it is recommended that CUPS be removed to reduce the potential attack surface."
    imoact: "Removing CUPS will prevent printing from the system, a common task for workstation systems."
    remediation: "Run one of the following commands to remove cups : # apt purge cups."
    references:
      - http://www.cups.org
    compliance:
      - cis: ["2.1.4"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s cups -> r:package 'cups' is not installed"

   # 2.1.5 Ensure DHCP Server is not installed (Automated)
  - id: 29530
    title: "Ensure DHCP Server is not installed."
    description: "The Dynamic Host Configuration Protocol (DHCP) is a service that allows machines to be dynamically assigned IP addresses."
    rationale: "If the system does not need to print jobs or accept print jobs from other systems, it is recommended that CUPS be removed to reduce the potential attack surface."
    imoact: "Removing CUPS will prevent printing from the system, a common task for workstation systems."
    remediation: "Run the following command to remove isc-dhcp-server: # apt purge isc-dhcp-server."
    references:
      - http://www.isc.org/software/dhcp.
    compliance:
      - cis: ["2.1.5"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s isc-dhcp-server -> r:package 'isc-dhcp-server' is not installed"

   # 2.1.6 Ensure LDAP server is not installed (Automated)
  - id: 29530
    title: "Ensure LDAP server is not installed."
    description: "The Lightweight Directory Access Protocol (LDAP) was introduced as a replacement for NIS/YP. It is a service that provides a method for looking up information from a central database."
    rationale: "If the system will not need to act as an LDAP server, it is recommended that the software be removed to reduce the potential attack surface."
    imoact: "Removing CUPS will prevent printing from the system, a common task for workstation systems."
    remediation: "Run one of the following commands to remove slapd: # apt purge slapd."
    references:
      - http://www.openldap.org.
    compliance:
      - cis: ["2.1.6"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s slapd -> r:package 'slapd' is not installed"

   # 2.1.7 Ensure NFS is not installed (Automated)
  - id: 29530
    title: "Ensure NFS is not installed."
    description: "The Network File System (NFS) is one of the first and most widely distributed file systems in the UNIX environment. It provides the ability for systems to mount file systems of other servers through the network."
    rationale: "If the system does not export NFS shares or act as an NFS client, it is recommended that these services be removed to reduce the remote attack surface."
    remediation: "Run the following command to remove nfs: # apt purge nfs-kernel-server."
    compliance:
      - cis: ["2.1.7"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s nfs-kernel-server -> r:package 'nfs-kernel-server' is not installed"

   # 2.1.8 Ensure DNS Server is not installed (Automated)
  - id: 29530
    title: "Ensure DNS Server is not installed."
    description: "The Domain Name System (DNS) is a hierarchical naming system that maps names to IP addresses for computers, services and other resources connected to a network."
    rationale: "Unless a system is specifically designated to act as a DNS server, it is recommended that the package be deleted to reduce the potential attack surface."
    remediation: "Run the following commands to disable DNS server: # apt purge bind9."
    compliance:
      - cis: ["2.1.8"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s bind9 -> r:package 'bind9' is not installed"

   # 2.1.9 Ensure FTP Server is not installed (Automated)
  - id: 29530
    title: "Ensure FTP Server is not installed."
    description: "The File Transfer Protocol (FTP) provides networked computers with the ability to transfer files. Note: Additional FTP servers also exist and should be audited."
    rationale: "FTP does not protect the confidentiality of data or authentication credentials. It is recommended SFTP be used if file transfer is required. Unless there is a need to run the system as a FTP server (for example, to allow anonymous downloads), it is recommended that the package be deleted to reduce the potential attack surface."
    remediation: "Run the following command to remove vsftpd: # apt purge vsftpd."
    compliance:
      - cis: ["2.1.9"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s vsftpd -> r:package 'vsftpd' is not installed"

   # 2.1.10 Ensure HTTP server is not installed (Automated)
  - id: 29530
    title: "Ensure HTTP server is not installed."
    description: "HTTP or web servers provide the ability to host web site content. Note: Several httpd servers exist and can use other service names. apache2 and nginx are example services that provide an HTTP server. These and other services should also be audited."
    rationale: "Unless there is a need to run the system as a web server, it is recommended that the package be deleted to reduce the potential attack surface."
    remediation: "Run the following command to remove apache: # apt purge apache2."
    compliance:
      - cis: ["2.1.10"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s apache2 -> r:package 'apache2' is not installed"

   # 2.1.11 Ensure IMAP and POP3 server are not installed (Automated)
  - id: 29530
    title: "Ensure IMAP and POP3 server are not installed."
    description: "dovecot-imapd and dovecot-pop3d are an open source IMAP and POP3 server for Linux based systems. Note: Several IMAP/POP3 servers exist and can use other service names. courier-imap and cyrus-imap are example services that provide a mail server. These and other services should also be audited."
    rationale: "Unless POP3 and/or IMAP servers are to be provided by this system, it is recommended that the package be removed to reduce the potential attack surface."
    remediation: "Run one of the following commands to remove dovecot-imapd and dovecot-pop3d: # apt purge dovecot-imapd dovecot-pop3d."
    compliance:
      - cis: ["2.1.11"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s dovecot-imapd -> r:package 'dovecot-imapd' is not installed"
      - "c:dpkg -s dovecot-pop3d -> r:package 'dovecot-pop3d' is not installed"

   # 2.1.12 Ensure Samba is not installed (Automated)
  - id: 29530
    title: "Ensure Samba is not installed."
    description: "The Samba daemon allows system administrators to configure their Linux systems to share file systems and directories with Windows desktops. Samba will advertise the file systems and directories via the Server Message Block (SMB) protocol. Windows desktop users will be able to mount these directories and file systems as letter drives on their systems."
    rationale: "If there is no need to mount directories and file systems to Windows systems, then this service should be deleted to reduce the potential attack surface."
    remediation: "Run the following command to remove samba: # apt purge samba."
    compliance:
      - cis: ["2.1.12"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s samba -> r:package 'samba' is not installed"

  # 2.1.13 Ensure HTTP Proxy Server is not installed (Automated)
  - id: 29530
    title: "Ensure HTTP Proxy Server is not installed."
    description: "Squid is a standard proxy server used in many distributions and environments. Note: Several HTTP proxy servers exist. These and other services should be checked."
    rationale: "If there is no need for a proxy server, it is recommended that the squid proxy be deleted to reduce the potential attack surface."
    remediation: "Run the following command to remove squid: # apt purge squid."
    compliance:
      - cis: ["2.1.13"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s squid -> r:package 'squid' is not installed"

  # 2.1.14 Ensure SNMP Server is not installed (Automated)
  - id: 29530
    title: "Ensure SNMP Server is not installed."
    description: "Simple Network Management Protocol (SNMP) is a widely used protocol for monitoring the health and welfare of network equipment, computer equipment and devices like UPSs. Net-SNMP is a suite of applications used to implement SNMPv1 (RFC 1157), SNMPv2 (RFCs 1901-1908), and SNMPv3 (RFCs 3411-3418) using both IPv4 and IPv6. Support for SNMPv2 classic (a.k.a. \"SNMPv2 historic\" - RFCs 1441-1452) was dropped with the 4.0 release of the UCD-snmp package. The Simple Network Management Protocol (SNMP) server is used to listen for SNMP commands from an SNMP management system, execute the commands or collect the information and then send results back to the requesting system."
    rationale: "The SNMP server can communicate using SNMPv1, which transmits data in the clear and does not require authentication to execute commands. SNMPv3 replaces the simple/clear text password sharing used in SNMPv2 with more securely encoded parameters. If the the SNMP service is not required, the net-snmp package should be removed to reduce the attack surface of the system. Note: If SNMP is required: - The server should be configured for SNMP v3 only. User Authentication and Message Encryption should be configured. - If SNMP v2 is absolutely necessary, modify the community strings' values."
    remediation: "Run the following command to remove snmpd: # apt purge snmpd."
    compliance:
      - cis: ["2.1.14"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s snmpd -> r:package 'snmpd' is not installed"

  # 2.1.15 Ensure mail transfer agent is configured for local-only mode (Automated)
  - id: 29530
    title: "Ensure mail transfer agent is configured for local-only mode."
    description: "Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to listen for incoming mail and transfer the messages to the appropriate user or mail server. If the system is not intended to be a mail server, it is recommended that the MTA be configured to only process local mail."
    rationale: "The software for all Mail Transfer Agents is complex and most have a long history of security issues. While it is important to ensure that the system can process local mail messages, it is not necessary to have the MTA's daemon listening on a port unless the server is intended to be a mail server that receives and processes mail from other systems. Note: This recommendation is designed around the exim4 mail server, depending on your environment you may have an alternative MTA installed such as sendmail. If this is the case consult the documentation for your installed MTA to configure the recommended state."
    remediation: "Edit /etc/exim4/update-exim4.conf.conf and and or modify following lines to look like the lines below: dc_eximconfig_configtype='local' dc_local_interfaces='127.0.0.1 ; ::1' dc_readhost='' dc_relay_domains='' dc_minimaldns='false' dc_relay_nets='' dc_smarthost='' dc_use_split_config='false' dc_hide_mailname='' dc_mailname_in_oh='true' dc_localdelivery='mail_spool' Restart exim4: # systemctl restart exim4."
    compliance:
      - cis: ["2.1.15"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: none
    rules:
      - 'c:ss -lntu -> r:\.*:25 && r:\.*LISTEN && !r:127.0.0.1:25|[::1]:25'

  # 2.1.16 Ensure rsync service is not installed (Automated)
  - id: 29530
    title: "Ensure rsync service is not installed."
    description: "The rsync service can be used to synchronize files between systems over network links."
    rationale: "The rsync service presents a security risk as it uses unencrypted protocols for communication. The rsync package should be removed to reduce the attack area of the system."
    remediation: "Run the following command to remove rsync: # apt purge rsync."
    compliance:
      - cis: ["2.1.16"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s rsync -> r:package 'rsync' is not installed"

  # 2.1.17 Ensure NIS Server is not installed (Automated)
  - id: 29530
    title: "Ensure NIS Server is not installed."
    description: "The Network Information Service (NIS) (formally known as Yellow Pages) is a client-server directory service protocol for distributing system configuration files. The NIS server is a collection of programs that allow for the distribution of configuration files."
    rationale: "The NIS service is inherently an insecure system that has been vulnerable to DOS attacks, buffer overflows and has poor authentication for querying NIS maps. NIS generally has been replaced by such protocols as Lightweight Directory Access Protocol (LDAP). It is recommended that the service be removed and other, more secure services be used."
    remediation: "Run the following command to remove nis: # apt purge nis."
    compliance:
      - cis: ["2.1.17"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s nis -> r:package 'nis' is not installed"

 #####################################
 # 2.2 Service Clients
 #####################################

  # 2.2.1 Ensure NIS Client is not installed (Automated)
  - id: 29530
    title: "Ensure NIS Server is not installed."
    description: "The Network Information Service (NIS), formerly known as Yellow Pages, is a client-server directory service protocol used to distribute system configuration files. The NIS client was used to bind a machine to an NIS server and receive the distributed configuration files."
    rationale: "The NIS service is inherently an insecure system that has been vulnerable to DOS attacks, buffer overflows and has poor authentication for querying NIS maps. NIS generally has been replaced by such protocols as Lightweight Directory Access Protocol (LDAP). It is recommended that the service be removed."
    impact: "Many insecure service clients are used as troubleshooting tools and in testing environments. Uninstalling them can inhibit capability to test and troubleshoot. If they are required it is advisable to remove the clients after use to prevent accidental or intentional misuse."
    remediation: "Uninstall nis: apt purge nis."
    compliance:
      - cis: ["2.2.1"]
      - cis_csc_v7: ["2.6"]
      - cmmc_v2.0: ["CM.2.063", "CM.3.069", "CM.4.073"]
      - iso_27001-2013: ["A.12.5.1", "A.12.6.2"]
      - mitre_techniques: ["T1191", "T1092", "T1175", "T1173", "T1519", "T1052", "T1210", "T1133", "T1118", "T1171", "T1170", "T1046", "T1137", "T1086", "T1164", "T1121", "T1076", "T1091", "T1180", "T1064", "T1184", "T1221", "T1127", "T1028"]
      - nist_sp_800-53: ["CM-11"]
    condition: all
    rules:
      - "c:dpkg -s nis -> r:package 'nis' is not installed"

  # 2.2.2 Ensure rsh client is not installed (Automated)
  - id: 29530
    title: "Ensure rsh client is not installed."
    description: "The rsh-client package contains the client commands for the rsh services."
    rationale: "These legacy clients contain numerous security exposures and have been replaced with the more secure SSH package. Even if the server is removed, it is best to ensure the clients are also removed to prevent users from inadvertently attempting to use these commands and therefore exposing their credentials. Note that removing the rsh package removes the clients for rsh , rcp and rlogin."
    impact: "Many insecure service clients are used as troubleshooting tools and in testing environments. Uninstalling them can inhibit capability to test and troubleshoot. If they are required it is advisable to remove the clients after use to prevent accidental or intentional misuse."
    remediation: "Uninstall rsh: apt purge rsh-client."
    compliance:
      - cis: ["2.2.2"]
      - cis_csc_v7: ["4.5"]
      - cmmc_v2.0: ["IA.3.083"]
      - iso_27001-2013: ["A.9.4.3"]
      - mitre_techniques: ["T1176", "T1501", "T1098", "T1017", "T1110", "T1136", "T1530", "T1114", "T1133", "T1040", "T1076", "T1021", "T1539", "T1072", "T1078", "T1134", "T1067", "T1088", "T1175", "T1003", "T1214", "T1190", "T1210", "T1495", "T1525", "T1208", "T1215", "T1075", "T1097", "T1086", "T1055", "T1053", "T1505", "T1035", "T1051", "T1218", "T1184", "T1169", "T1206", "T1100", "T1077", "T1047", "T1084", "T1028"]
      - pci_dss_v3.2.1: ["2.3", "8.3", "8.3.1", "8.3.2"]
    condition: all
    rules:
      - "c:dpkg -s rsh-client -> r:package 'rsh-client' is not installed"

  # 2.2.3 Ensure talk client is not installed (Automated)
  - id: 29530
    title: "Ensure talk client is not installed."
    description: "The talk software makes it possible for users to send and receive messages across systems through a terminal session. The talk client, which allows initialization of talk sessions, is installed by default."
    rationale: "The software presents a security risk as it uses unencrypted protocols for communication."
    impact: "Many insecure service clients are used as troubleshooting tools and in testing environments. Uninstalling them can inhibit capability to test and troubleshoot. If they are required it is advisable to remove the clients after use to prevent accidental or intentional misuse."
    remediation: "Uninstall talk: apt purge talk."
    compliance:
      - cis: ["2.2.3"]
      - cis_csc_v7: ["2.6"]
      - cmmc_v2.0: ["CM.2.063", "CM.3.069", "CM.4.073"]
      - iso_27001-2013: ["A.12.5.1", "A.12.6.2"]
      - mitre_techniques: ["T1191", "T1092", "T1175", "T1173", "T1519", "T1052", "T1210", "T1133", "T1118", "T1171", "T1170", "T1046", "T1137", "T1086", "T1164", "T1121", "T1076", "T1091", "T1180", "T1064", "T1184", "T1221", "T1127", "T1028"]
      - nist_sp_800-53: ["CM-11"]
    condition: all
    rules:
      - "c:dpkg -s talk -> r:package 'talk' is not installed"

  # 2.2.4 Ensure telnet client is not installed (Automated)
  - id: 29530
    title: "Ensure telnet client is not installed."
    description: "The telnet package contains the telnet client, which allows users to start connections to other systems via the telnet protocol."
    rationale: "The telnet protocol is insecure and unencrypted. The use of an unencrypted transmission medium could allow an unauthorized user to steal credentials. The ssh package provides an encrypted session and stronger security and is included in most Linux distributions."
    impact: "Many insecure service clients are used as troubleshooting tools and in testing environments. Uninstalling them can inhibit capability to test and troubleshoot. If they are required it is advisable to remove the clients after use to prevent accidental or intentional misuse."
    remediation: "Uninstall telnet: # apt purge telnet."
    compliance:
      - cis: ["2.2.4"]
      - cis_csc_v7: ["4.5"]
      - cmmc_v2.0: ["IA.3.083"]
      - iso_27001-2013: ["A.9.4.3"]
      - mitre_techniques: ["T1176", "T1501", "T1098", "T1017", "T1110", "T1136", "T1530", "T1114", "T1133", "T1040", "T1076", "T1021", "T1539", "T1072", "T1078", "T1134", "T1067", "T1088", "T1175", "T1003", "T1214", "T1190", "T1210", "T1495", "T1525", "T1208", "T1215", "T1075", "T1097", "T1086", "T1055", "T1053", "T1505", "T1035", "T1051", "T1218", "T1184", "T1169", "T1206", "T1100", "T1077", "T1047", "T1084", "T1028"]
      - pci_dss_v3.2.1: ["2.3", "8.3", "8.3.1", "8.3.2"]
    condition: all
    rules:
      - "c:dpkg -s telnet -> r:package 'telnet' is not installed"

  # 2.2.5 Ensure LDAP client is not installed (Automated)
  - id: 29530
    title: "Ensure LDAP client is not installed."
    description: "The Lightweight Directory Access Protocol (LDAP) was introduced as a replacement for NIS/YP. It is a service that provides a method for looking up information from a central database."
    rationale: "If the system will not need to act as an LDAP client, it is recommended that the software be removed to reduce the potential attack surface."
    impact: "Removing the LDAP client will prevent or inhibit using LDAP for authentication in your environment."
    remediation: "Uninstall ldap-utils: # apt purge ldap-utils."
    compliance:
      - cis: ["2.2.5"]
      - cis_csc_v7: ["2.6"]
      - cmmc_v2.0: ["CM.2.063", "CM.3.069", "CM.4.073"]
      - iso_27001-2013: ["A.12.5.1", "A.12.6.2"]
      - mitre_techniques: ["T1191", "T1092", "T1175", "T1173", "T1519", "T1052", "T1210", "T1133", "T1118", "T1171", "T1170", "T1046", "T1137", "T1086", "T1164", "T1121", "T1076", "T1091", "T1180", "T1064", "T1184", "T1221", "T1127", "T1028"]
      - nist_sp_800-53: ["CM-11"]
    condition: all
    rules:
      - "c:dpkg -s ldap-utils -> r:package 'ldap-utils' is not installed"

  # 2.2.6 Ensure RPC is not installed (Automated)
  - id: 29530
    title: "Ensure RPC is not installed."
    description: "Remote Procedure Call (RPC) is a method for creating low level client server applications across different system architectures. It requires an RPC compliant client listening on a network port. The supporting package is rpcbind."
    rationale: "If RPC is not required, it is recommended that this services be removed to reduce the remote attack surface."
    remediation: "Run the following command to remove rpcbind: # apt purge rpcbind."
    compliance:
      - cis: ["2.2.5"]
      - cis_csc_v7: ["9.2"]
      - cmmc_v2.0: ["CM.3.068", "SC.5.230"]
      - iso_27001-2013: ["A.13.1.3"]
      - mitre_techniques: ["T1015", "T1133", "T1200", "T1076", "T1051"]
      - nist_sp_800-53: ["SI-4"]
      - pci_dss_v3.2.1: ["1.2.1", "2.2.2", "2.2.5"]
    condition: all
    rules:
      - "c:dpkg -s rpcbind -> r:package 'rpcbind' is not installed"

 # 2.3 Ensure nonessential services are removed or masked (Manual) - Not Implemented
 ###################################################
 # 3 Network Configuration
 ###################################################
 # 3.1 Disable unused network protocols and devices
 ###################################################