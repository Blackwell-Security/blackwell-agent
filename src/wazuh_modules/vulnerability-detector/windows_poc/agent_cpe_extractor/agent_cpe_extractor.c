#include "../external/wazuh_tools.h"



int main() {
    agent_software *agent;
    sqlite3 *db;
    sqlite3_stmt *stmt = NULL;

    os_calloc(1, sizeof(agent_software), agent);
    agent->agent_id = strdup("003");

    if (sqlite3_open_v2(CPE_DB, &db, SQLITE_OPEN_READWRITE, NULL) != SQLITE_OK) {
        return wm_vuldet_sql_error(db, stmt);
    }

    if (wm_vuldet_get_software_info(agent, db, -47, -47)) {
        printf("ERROR: Could not get the agent package list.");
        return 1;
    }

    /*
    if (extract_agent_cpes(agent, db)) {
        printf("ERROR: Could not get the agent package list.");
        return 1;
    }*/

    return 0;
}
