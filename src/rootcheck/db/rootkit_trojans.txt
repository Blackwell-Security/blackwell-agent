# $rootcheck, rootkit_trojans.txt, v1.0 2005/10/01, Daniel B. Cid
# Imported from the rootcheck project.

# Lines starting with '#' are not going to be read.
# Blank lines are not going to be read too.
# 
# Each line must be in the following format:
# file_name !string_to_search

# Commom binaries and public trojan entries
ls          !bash|^/bin/sh|dev/[^cl]|\.tmp/lsfile|duarawkz|/prof|security|file\.h
env			!bash|^/bin/sh|file\.h|proc\.h|/dev/|^/bin/.*sh
echo		!bash|^/bin/sh|file\.h|proc\.h|/dev/[^cl]|^/bin/.*sh
chown		!bash|^/bin/sh|file\.h|proc\.h|/dev/[^cl]|^/bin/.*sh
chmod		!bash|^/bin/sh|file\.h|proc\.h|/dev/[^cl]|^/bin/.*sh
chgrp		!bash|^/bin/sh|file\.h|proc\.h|/dev/[^cl]|^/bin/.*sh
cat			!bash|^/bin/sh|file\.h|proc\.h|/dev/[^cl]|^/bin/.*sh
bash		!^/bin/sh|file\.h|proc\.h|/dev/[0-9]|/dev/[hijkz]|^/bin/.*sh
sh			!file\.h|proc\.h|/dev/[0-9]|/dev/[hijkz]
uname		!bash|^/bin/sh|file\.h|proc\.h|/dev/|^/bin/.*sh
date		!bash|^/bin/sh|file\.h|proc\.h|/dev/[^cl]|^/bin/.*sh
du			!/dev|w0rm|/prof|file\.h
df			!bash|^/bin/sh|file\.h|proc\.h|/dev/[^cl]|^/bin/.*sh
login      	!bash|elite|klogin\.c|SucKIT|xlogin|vejeta|porcao 
passwd		!bash|file\.h|proc\.h|/dev/ttyo|/dev/[A-Z]|/dev/[a-s,uvxz]
mingetty	!bash|Dimensioni|pacchetto
chfn		!bash|file\.h|proc\.h|/dev/ttyo|/dev/[A-Z]|/dev/[a-s,uvxz]
chsh		!bash|file\.h|proc\.h|/dev/ttyo|/dev/[A-Z]|/dev/[a-s,uvxz]
mail		!bash|file\.h|proc\.h|/dev/[^n]
su			!bash|/dev/[a-s,uvxz]|/dev/[A-D]|/dev/[F-Z]|/dev/[0-9]|satori|vejeta|conf\.inv
sudo		!bash|satori|vejeta|conf\.inv
crond		!/dev/[^nt]|bash
gpm			!bash|mingetty
ifconfig	!bash|^/bin/sh|/dev/tux|session.null|/dev/[^cl]
diff		!bash|^/bin/sh|file\.h|proc\.h|/dev/[^n]|^/bin/.*sh
md5sum		!bash|^/bin/sh|file\.h|proc\.h|/dev/|^/bin/.*sh
hdparm		!bash|/dev/ida|/dev/
ldd			!/dev/[^n]|proc\.h|libshow.so|libproc.a


# Trojan entries for troubleshooting binaries

grep        !bash|givemer|/dev/
egrep		!bash|^/bin/sh|file\.h|proc\.h|/dev/|^/bin/.*sh
find		!bash|/dev/[0-9]|/dev/[a-r]|/prof|/home/virus|security|file\.h
lsof		!/prof|/dev/[^n]|proc\.h|bash|^/bin/sh|/dev/ttyo|/dev/ttyp
netstat		!bash|^/bin/sh|/dev/|/prof|grep|addr\.h
top			!/dev/|proc\.h|/prof
ps			!/dev/ttyo|\.1proc|proc\.h|bash|^/bin/sh	
tcpdump		!bash|^/bin/sh|file\.h|proc\.h|/dev/[^b]|^/bin/.*sh
pidof		!bash|^/bin/sh|file\.h|proc\.h|/dev/|^/bin/.*sh
fuser		!bash|^/bin/sh|file\.h|proc\.h|/dev/|^/bin/.*sh
w			!uname -a|proc\.h|bash|^/dev/|/dev/[a-s,uvxz]|/dev/[A-O]|/dev/Q-Z]


# Trojan entries for common daemons

sendmail	!bash|fuck
named		!bash|blah|/dev/[0-9]|^/bin/sh
inetd		!bash|^/bin/sh|file\.h|proc\.h|/dev/[^n]|^/bin/.*sh
apachectl	!bash|^/bin/sh|file\.h|proc\.h|/dev/[^n]|^/bin/.*sh
sshd		!check_global_passwd|panasonic|satori|vejeta|\.ark|/hash\.zk|bash|/dev[a-s]|/dev[A-Z]/
syslogd		!bash|/usr/lib/pt07|/dev/[^cln]]|syslogs\.h|^/bin/sh|proc\.h
xinetd		!bash|^/bin/sh|file\.h|proc\.h|^/bin/.*sh
in.telnetd	!cterm100|vt350|VT100|ansi-term|bash|^/bin/sh|/dev[A-R]|/dev/[a-z]/
in.fingerd	!bash|^/bin/sh|cterm100|/dev/
identd		!bash|^/bin/sh|file\.h|proc\.h|/dev/|^/bin/.*sh
init		!bash|/dev/h
tcpd		!bash|^/bin/sh|proc\.h|p1r0c4|hack|/dev/
rlogin		!p1r0c4|r00t|bash|/dev/[^nt]


# Kill trojan

killall		!/dev/|proc\.h|bash|tmp
kill		!/dev/[ab,d-k,m-z]|/dev/[F-Z]|/dev/[A-D]|/dev/[0-9]|proc\.h|bash|tmp

# EOF #
